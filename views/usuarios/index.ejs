<%- include('../partials/header')-%>

<div class="container">
     <div class="card mt-3">
        <div class="card-header">
             <h3 class="card-title">
                 Cadastro de usuários
             </h3>
        </div>
        <div class="card-body">
             <form action="/usuario/cadastrar" method="post">
                <label for="nome">Nome:</label>
                <input class="form-control" type="text" name="nome"><br>
                <label for="nome">Login:</label>
                <input class="form-control" type="number" name="login"><br>
                <label for="nome">Senha:</label>
                <input class="form-control" type="password" name="senha"><br>
                <label for="detahes">Detalhes:</label>
                <input class="form-control" type="text" name="detalhes"><br>
                <label for="nivel">Nivel:</label>
                <input class="form-control" type="number" name="nivel"><br>
                <button class="btn btn-secondary mt-3" ><i class="fa-solid fa-floppy-disk"></i></button>
                <a class="btn btn-secondary mt-3" href="http://localhost:8070/"><i class="fa-solid fa-xmark"></i></i></a>
                <a class="btn btn-secondary mt-3" href="/itens"><i class="fa-solid fa-arrows-rotate"></i></a>
             </form>
        </div>
     </div>
     <div class="card mt-3">
        <div class="card-header">
             <h3 class="card-title">
                 Cadastro de usuários
             </h3>
        </div>
        <div class="card-body">
            <div class="card-header">
                <div class="card-title">
                    Usuários cadastrados 
                    <button type="button" class="btn btn-secondary" style="margin-left: 10%;" data-toggle="modal" data-target="#exampleModal">
                        <i class="fa-duotone fa-solid fa-magnifying-glass"></i>
                    </button>
                </div> 
            </div>

            <div class="card-body">
                <div style="overflow-x: auto; max-height: 90%; scrollbar-width: thin;">
                    <ul class="list-group">

                        <% usuarios.forEach(usuario=>{ %>
                            <li class="list-group-item" style="display: flex; font-size: 125%;">
                                <%= usuario.id %>-
                                <%= usuario.nome %>
                                <form class="" action="/usuario/apagar" method="post">
            
                                    <input type="hidden" value="<%= usuario.id %>" name="id">
            
                                    <button class="btn btn-secondary ml-1 mr-1" >
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </form>
                                
                                <a href="/usuario/edicao/<%= usuario.id %>" class="btn btn-secondary mr-1 ml-1" ><i class="fa-solid fa-pen-to-square"></i></a>
            
                            </li>
                        <%  }) %>
                    </ul>
                </div>
            </div>
           
        </div>
     </div>
</div>





<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>



        <div class="modal-body">


            <input class="form-control" type="text" id="search" placeholder="Buscar produtos...">

            <div id="produtos">
                <% usuarios.forEach(usuario => { %>

                    <ul class="produto list-group " data-nome="<%= usuario.nome %>">

                        <li class="list-group-item" ><%= usuario.nome %> <a class="text-secondary" href="/usuario/edicao/<%= usuario.id %>"><i class="fa-solid fa-circle-info"></i></a></li>
                        
                    </ul>
                <% }) %>
            </div>
         
        </div>



        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa-solid fa-xmark"></i></button>
        </div>
      </div>
    </div>
  </div>


<script>
    const searchInput = document.getElementById('search');
        const produtos = document.querySelectorAll('.produto');

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();

            produtos.forEach(produto => {
                const nome = produto.getAttribute('data-nome').toLowerCase();

                if (nome.includes(searchTerm)) {

                    produto.style.display = 'block'; // mostra o produto

                } else {

                    produto.style.display = 'none'; // oculta o produto
                }
            });
        });


document.getElementById('itemForm').onsubmit = function() {

    var precoInput = document.getElementById('preco');

    precoInput.value = precoInput.value.replace(',', '.');
    
};

</script>

<%- include('../partials/footer')-%>